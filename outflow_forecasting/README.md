# Прогнозирование оттока клиентов в сети отелей

## Цель проекта
Для привлечения клиентов сеть отелей добавила на свой сайт возможность забронировать номер без предоплаты. Но возникла следующая проблема: при отмене бронирования клиентом компания терпела убытки. Для решения проблемы необходимо разработать модель машинного обучения, которая предсказывает отказ от брони. Клиенту, который определяется моделью как потенциально отказавшийся от брони, предлагается внести депозит. Депозит составляет 80% от стоимости номера за одни сутки и затрат на разовую уборку.

## Исходные данные
Заказчиком было предоставлено два датасета: с обучающими данными и тестовыми. В тестовом датасете содержатся данные за 2017 год (8 месяцев), в обучающем - за 2015 год (6 месяцев) и 2016 год (12 месяцев).

Основная бизнес-метрика для любой сети отелей — её прибыль. Прибыль отеля — это разница между стоимостью номера за все ночи и затратами на обслуживание: как при подготовке номера, так и при проживании постояльца. В отеле есть несколько типов номеров. В зависимости от типа номера назначается стоимость за одну ночь. Есть также затраты на уборку. Если клиент снял номер надолго, то убираются каждые два дня.

Стоимость номеров отеля:
- категория A: за ночь — 1 000, разовое обслуживание — 400;
- категория B: за ночь — 800, разовое обслуживание — 350;
- категория C: за ночь — 600, разовое обслуживание — 350;
- категория D: за ночь — 550, разовое обслуживание — 150;
- категория E: за ночь — 500, разовое обслуживание — 150;
- категория F: за ночь — 450, разовое обслуживание — 150;
- категория G: за ночь — 350, разовое обслуживание — 150.

В ценовой политике отеля используются сезонные коэффициенты: весной и осенью цены повышаются на 20%, летом — на 40%.

На разработку системы прогнозирования заложен бюджет — 400 000. При этом необходимо учесть, что внедрение модели должно окупиться за год. Затраты на разработку должны быть меньше той выручки, которую система принесёт компании.

## Используемые библиотеки
Для запуска проекта необходимо установить следующие библиотеки:
- matplotlib
- pandas
- seaborn
- sklearn
 
## Что было сделано
Я загрузила два датафрейма с информацией о бронировании номера: тренировочный датасет содержит 65229 строк 25 столбцов; тестовый - 32412 строк и также 25 столбцов.
- сделала группировку по сторонам света, так как в столбце с кодом страны было более 130 значений, а после группировки стало 6, что значительно улучшило процесс кодировки категориальных признаков;
- удалила неявные дубликаты - пустые символы в конце строки;
- исследовала признаки графическими средствами и избавилась от выбросов;
- посмотрела как зависит отмена бронирования от различных признаков и составила портрет "ненадежного" клиента;
- вычислила бизнес-метрику - прибыль отеля без внедрения депозита.

Далее приступила к разработке модели ML по прогнозированию оттока:
- подготовила признаки для обучения (масштабирование, кодирование), GridSearchCV подобрала гиперпараметры для моделей классификации;
- по итогам кросс-валидации выбрала наилучшую модель и сделала предсказание на тестовом датасете; дополнительно провела исследование ROC-кривой.

Получив прогнозы модели, я рассчитала прибыль отеля с учетом прогноза оттока клиентов. 
Полученное значение прибыли после прогноза модели превзошло в 1,5 раза прибыль до внедрения модели. 

## Итоговые результаты
Соблюдено главное пожелание заказчика: затраты на разработку и внедрение модели (400 тыс) окупятся за один год.
Я рассчитала бизнес-метрику: прибыль после внедрения модели, ее значение составило 18 679 964 руб., что в 1,5 раза больше прибыли до внедрения системы прогнозирования оттока.
По итогам исследования составила портрет "ненадёжного" клиента для заказчика: клиент является частным лицом, бронирует самую дорогую категорию номера («А») для проживания двух человек, без детей, планирует остановиться от 1 до 4-х дней включительно в осенние месяцы – сентябрь и октябрь и в качестве опции заказа выбирает «завтрак». Также не делает специальных отметок в информации о бронировании, не изменяет параметров заказа и до этого еще не совершал отмену брони.